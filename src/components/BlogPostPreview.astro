---
import type { CollectionEntry } from 'astro:content';
import ResponsiveImage from './ResponsiveImage.astro';
import { formatDate } from '../utils/dates';

interface Props {
  post: CollectionEntry<'blog'>;
}

const { post } = Astro.props;
const { title, description, pubDate, heroImage, heroCaption, tags } = post.data;
const formattedDate = formatDate(pubDate);
---

<article class="group relative flex flex-col gap-4 py-6">
  <div class="flex flex-col gap-2">
    <header>
      <h2 class="text-2xl font-bold">
        <a href={`/blog/${post.slug}`} class="hover:text-primary">
          {title}
        </a>
      </h2>
      <time datetime={pubDate.toISOString()} class="text-sm text-gray-600 dark:text-gray-400">
        {formattedDate}
      </time>
    </header>
    {
      heroImage && (
        <div class="relative aspect-[2/1] overflow-hidden rounded-lg">
          <ResponsiveImage
            src={heroImage}
            alt={heroCaption || title}
            sizes="(min-width: 768px) 768px, 100vw"
            class="object-cover"
          />
        </div>
      )
    }
    <p class="text-gray-700 dark:text-gray-300">
      {description}
    </p>
  </div>
  {
    tags.length > 0 && (
      <div class="flex flex-wrap gap-2">
        {tags.map((tag: string) => (
          <a
            href={`/tags/${tag}`}
            class="rounded-full bg-gray-100 px-3 py-1 text-sm text-gray-700 hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700"
          >
            #{tag}
          </a>
        ))}
      </div>
    )
  }
  <a
    href={`/blog/${post.slug}`}
    class="focus:ring-primary absolute inset-0 z-0 focus:ring-2 focus:outline-none"
    aria-label={`Read more about ${title}`}
  >
    <span class="sr-only">Read more</span>
  </a>
</article>
